<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quaternity: src/update.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quaternity
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">update.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file defines functions for updating the state.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="graph_8h_source.html">graph.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="match_8h_source.html">match.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="round_8h_source.html">round.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="settings_8h_source.html">settings.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="state_8h_source.html">state.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="update_8h_source.html">update.h</a>&quot;</code><br />
</div>
<p><a href="update_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a05e0bd8b6c4e581dd20efe05e646fe05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8cpp.html#a05e0bd8b6c4e581dd20efe05e646fe05">update_onturn</a> (const <a class="el" href="structSettings.html">Settings</a> &amp;settings, <a class="el" href="structState.html">State</a> &amp;state, const <a class="el" href="structQuestion.html">Question</a> &amp;question)</td></tr>
<tr class="memdesc:a05e0bd8b6c4e581dd20efe05e646fe05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the player onturn such that he has cards for sure.  <a href="update_8cpp.html#a05e0bd8b6c4e581dd20efe05e646fe05">More...</a><br /></td></tr>
<tr class="separator:a05e0bd8b6c4e581dd20efe05e646fe05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7f3b6e3f5bf3f465146e9453421626"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8cpp.html#ade7f3b6e3f5bf3f465146e9453421626">update_quartet</a> (const <a class="el" href="structSettings.html">Settings</a> &amp;settings, <a class="el" href="structState.html">State</a> &amp;state, const <a class="el" href="graph_8h.html#a3916589f387213c83aa4ebb9d4ade8c7">Graph</a> &amp;graph, int hand_offset, int player, int set)</td></tr>
<tr class="memdesc:ade7f3b6e3f5bf3f465146e9453421626"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the state such that the given player has the provided set.  <a href="update_8cpp.html#ade7f3b6e3f5bf3f465146e9453421626">More...</a><br /></td></tr>
<tr class="separator:ade7f3b6e3f5bf3f465146e9453421626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8c57cbb0958b7b1bfba8337ebac541b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8cpp.html#ab8c57cbb0958b7b1bfba8337ebac541b">update_quartets</a> (const <a class="el" href="structSettings.html">Settings</a> &amp;settings, <a class="el" href="structState.html">State</a> &amp;state, const <a class="el" href="structQuestion.html">Question</a> &amp;question)</td></tr>
<tr class="memdesc:ab8c57cbb0958b7b1bfba8337ebac541b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find if there are new quartets and update the state accordingly.  <a href="update_8cpp.html#ab8c57cbb0958b7b1bfba8337ebac541b">More...</a><br /></td></tr>
<tr class="separator:ab8c57cbb0958b7b1bfba8337ebac541b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43259ea462b7339aedd9d3dfc80e0c5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8cpp.html#a43259ea462b7339aedd9d3dfc80e0c5a">update_state</a> (const <a class="el" href="structSettings.html">Settings</a> &amp;settings, <a class="el" href="structState.html">State</a> &amp;state, const <a class="el" href="structQuestion.html">Question</a> &amp;question, const <a class="el" href="round_8h.html#a77da2cb3c716e1673bbfe93f6d167a28">Answer</a> &amp;answer)</td></tr>
<tr class="memdesc:a43259ea462b7339aedd9d3dfc80e0c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the state of the game according to the question asked and the answer which is given.  <a href="update_8cpp.html#a43259ea462b7339aedd9d3dfc80e0c5a">More...</a><br /></td></tr>
<tr class="separator:a43259ea462b7339aedd9d3dfc80e0c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file defines functions for updating the state. </p>

<p class="definition">Definition in file <a class="el" href="update_8cpp_source.html">update.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a05e0bd8b6c4e581dd20efe05e646fe05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e0bd8b6c4e581dd20efe05e646fe05">&#9670;&nbsp;</a></span>update_onturn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_onturn </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSettings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structState.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structQuestion.html">Question</a> &amp;&#160;</td>
          <td class="paramname"><em>question</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the player onturn such that he has cards for sure. </p>
<p>If the player onturn does not have any cards left after it got a new quartet, the player who the card was asked from will be onturn. If that player also does not have any cards, we choose the first player in the player list with cards, if there is none we set onturn to -1. </p>

<p class="definition">Definition at line <a class="el" href="update_8cpp_source.html#l00025">25</a> of file <a class="el" href="update_8cpp_source.html">update.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// player onturn does not have any cards</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="state_8cpp.html#ac1837e63a84bf784b845d6b685d757f5">info_num_cards</a>(settings, state, state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a>) == 0) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">// player asked does not have any cards</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="state_8cpp.html#ac1837e63a84bf784b845d6b685d757f5">info_num_cards</a>(settings, state, question.<a class="code" href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">player</a>) &gt; 0)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a> = question.<a class="code" href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">player</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="comment">// choose the first player with cards from the player list</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> player = 0; player &lt; settings.<a class="code" href="structSettings.html#a86e8b42ad2fcbb6bb68f2b02b932899a">NUM_PLAYERS</a>; player++)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="state_8cpp.html#ac1837e63a84bf784b845d6b685d757f5">info_num_cards</a>(settings, state, player) &gt; 0) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a> = player;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a> = -1;  <span class="comment">// no players with cards left</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="ttc" id="astate_8cpp_html_ac1837e63a84bf784b845d6b685d757f5"><div class="ttname"><a href="state_8cpp.html#ac1837e63a84bf784b845d6b685d757f5">info_num_cards</a></div><div class="ttdeci">int info_num_cards(const Settings &amp;settings, const State &amp;state, int player)</div><div class="ttdoc">Get the number of cards the player has without counting the cards from quartets, so the actual number...</div><div class="ttdef"><b>Definition:</b> <a href="state_8cpp_source.html#l00113">state.cpp:113</a></div></div>
<div class="ttc" id="astructQuestion_html_a8732aedb9654217fbfe736732c2e4d4b"><div class="ttname"><a href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">Question::player</a></div><div class="ttdeci">int player</div><div class="ttdoc">The player the question is asked to.</div><div class="ttdef"><b>Definition:</b> <a href="round_8h_source.html#l00022">round.h:22</a></div></div>
<div class="ttc" id="astructSettings_html_a86e8b42ad2fcbb6bb68f2b02b932899a"><div class="ttname"><a href="structSettings.html#a86e8b42ad2fcbb6bb68f2b02b932899a">Settings::NUM_PLAYERS</a></div><div class="ttdeci">const int NUM_PLAYERS</div><div class="ttdoc">The number of players playing the game.</div><div class="ttdef"><b>Definition:</b> <a href="settings_8h_source.html#l00037">settings.h:37</a></div></div>
<div class="ttc" id="astructState_html_a8473e0f33782aa5732beb378a228d383"><div class="ttname"><a href="structState.html#a8473e0f33782aa5732beb378a228d383">State::onturn</a></div><div class="ttdeci">int onturn</div><div class="ttdoc">The player who is on turn.</div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00062">state.h:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade7f3b6e3f5bf3f465146e9453421626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade7f3b6e3f5bf3f465146e9453421626">&#9670;&nbsp;</a></span>update_quartet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool update_quartet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSettings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structState.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="graph_8h.html#a3916589f387213c83aa4ebb9d4ade8c7">Graph</a> &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hand_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>player</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the state such that the given player has the provided set. </p>
<p>First we check if it is already known the player has the provided set. Next we make sure that in every possible matching the player has the set. To do this we execute the code shown below. If this succeeds we update the state such that every card from the provided set can only be assigned to the player and we set the quartets array entry to the player.</p>
<pre class="fragment">for card in quartet:
    remove all edges from player's hand to the card
    if match exists for graph:
       return
</pre><dl class="section return"><dt>Returns</dt><dd>if the player and set given is a new quartet </dd></dl>

<p class="definition">Definition at line <a class="el" href="update_8cpp_source.html#l00063">63</a> of file <a class="el" href="update_8cpp_source.html">update.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// check if we already know the quartet belongs to the player</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (state.<a class="code" href="structState.html#aaca9c1ef9cdf14200593649ac8bf370b">quartets</a>[set] == player)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// make sure that in every possible matching this player has the given set</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> card = set * settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a>; card &lt; (set + 1) * settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a>; card++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="graph_8h.html#a3916589f387213c83aa4ebb9d4ade8c7">Graph</a> graph_restricted = <a class="code" href="graph_8cpp.html#aa5c22c160511322ae746aea860671df4">graph_copy</a>(graph);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> hand_entry = 0; hand_entry &lt; state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[player].num_cards; hand_entry++)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            graph_restricted[hand_offset + hand_entry][card] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="match_8cpp.html#ab73b44a855bd0643a89ad27ed65a0765">match_exists</a>(graph_restricted))</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// update the state so only this player can have the cards from the set</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> card = set * settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a>; card &lt; (set + 1) * settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a>; card++) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        state.<a class="code" href="structState.html#a7ff72023586f1fa27512f4142f4f98af">cards</a>[card].players = std::vector&lt;bool&gt;(settings.<a class="code" href="structSettings.html#a86e8b42ad2fcbb6bb68f2b02b932899a">NUM_PLAYERS</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        state.<a class="code" href="structState.html#a7ff72023586f1fa27512f4142f4f98af">cards</a>[card].players[player] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    state.<a class="code" href="structState.html#aaca9c1ef9cdf14200593649ac8bf370b">quartets</a>[set] = player;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="agraph_8cpp_html_aa5c22c160511322ae746aea860671df4"><div class="ttname"><a href="graph_8cpp.html#aa5c22c160511322ae746aea860671df4">graph_copy</a></div><div class="ttdeci">Graph graph_copy(const Graph graph)</div><div class="ttdoc">Create a copy of the given graph.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8cpp_source.html#l00019">graph.cpp:19</a></div></div>
<div class="ttc" id="agraph_8h_html_a3916589f387213c83aa4ebb9d4ade8c7"><div class="ttname"><a href="graph_8h.html#a3916589f387213c83aa4ebb9d4ade8c7">Graph</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; bool &gt; &gt; Graph</div><div class="ttdoc">A bipartite graph where true booleans represent edges between a left node denoted as the row and a ri...</div><div class="ttdef"><b>Definition:</b> <a href="graph_8h_source.html#l00019">graph.h:19</a></div></div>
<div class="ttc" id="amatch_8cpp_html_ab73b44a855bd0643a89ad27ed65a0765"><div class="ttname"><a href="match_8cpp.html#ab73b44a855bd0643a89ad27ed65a0765">match_exists</a></div><div class="ttdeci">bool match_exists(const Graph &amp;graph)</div><div class="ttdoc">Check if there exists a matching for all cards.</div><div class="ttdef"><b>Definition:</b> <a href="match_8cpp_source.html#l00035">match.cpp:35</a></div></div>
<div class="ttc" id="astructSettings_html_a78cf5ed18d69ce74d769a4a9058154c5"><div class="ttname"><a href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">Settings::SET_SIZE</a></div><div class="ttdeci">const int SET_SIZE</div><div class="ttdoc">The size of one set, aka the number of cards in one set.</div><div class="ttdef"><b>Definition:</b> <a href="settings_8h_source.html#l00027">settings.h:27</a></div></div>
<div class="ttc" id="astructState_html_a4183466316e6a008061fdf0871d1cc87"><div class="ttname"><a href="structState.html#a4183466316e6a008061fdf0871d1cc87">State::players</a></div><div class="ttdeci">std::vector&lt; Player &gt; players</div><div class="ttdoc">The information on all the players.</div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00081">state.h:81</a></div></div>
<div class="ttc" id="astructState_html_a7ff72023586f1fa27512f4142f4f98af"><div class="ttname"><a href="structState.html#a7ff72023586f1fa27512f4142f4f98af">State::cards</a></div><div class="ttdeci">std::vector&lt; Card &gt; cards</div><div class="ttdoc">The information on all the cards.</div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00074">state.h:74</a></div></div>
<div class="ttc" id="astructState_html_aaca9c1ef9cdf14200593649ac8bf370b"><div class="ttname"><a href="structState.html#aaca9c1ef9cdf14200593649ac8bf370b">State::quartets</a></div><div class="ttdeci">std::vector&lt; int &gt; quartets</div><div class="ttdoc">The information of who has a certain quartet.</div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00090">state.h:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8c57cbb0958b7b1bfba8337ebac541b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8c57cbb0958b7b1bfba8337ebac541b">&#9670;&nbsp;</a></span>update_quartets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_quartets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSettings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structState.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structQuestion.html">Question</a> &amp;&#160;</td>
          <td class="paramname"><em>question</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find if there are new quartets and update the state accordingly. </p>
<p>First we generate a matching. We check for every player if they have all cards from a set (i.e. a quartet) in the found matching, if so we call <code>update_quartet</code> with the found player and set. If a new quartet is found, we use <code>update_onturn</code> to make sure that the player onturn has cards.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="update_8cpp.html#ade7f3b6e3f5bf3f465146e9453421626" title="Update the state such that the given player has the provided set.">update_quartet</a> </dd>
<dd>
<a class="el" href="update_8cpp.html#a05e0bd8b6c4e581dd20efe05e646fe05" title="Update the player onturn such that he has cards for sure.">update_onturn</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="update_8cpp_source.html#l00098">98</a> of file <a class="el" href="update_8cpp_source.html">update.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    assert(<a class="code" href="graph_8cpp.html#a2736b779e137cc954ea2df90d4a13327">graph_possible</a>(settings, state) &amp;&amp; <a class="code" href="match_8cpp.html#ab73b44a855bd0643a89ad27ed65a0765">match_exists</a>(<a class="code" href="graph_8cpp.html#af03096c2fe0f390705176a42529c71df">graph_create</a>(settings, state)));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// find any matching of the current state graph for checking of quartets</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="graph_8h.html#a3916589f387213c83aa4ebb9d4ade8c7">Graph</a> graph = <a class="code" href="graph_8cpp.html#af03096c2fe0f390705176a42529c71df">graph_create</a>(settings, state);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    std::vector&lt;int&gt; match = <a class="code" href="match_8cpp.html#a2f7536c94282af91f35b23dc2f727feb">match_find</a>(graph);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">bool</span> newquartet = <span class="keyword">false</span>;  <span class="comment">// indicates whether any new quartet was found</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">int</span> hand_offset = 0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> player = 0; player &lt; settings.<a class="code" href="structSettings.html#a86e8b42ad2fcbb6bb68f2b02b932899a">NUM_PLAYERS</a>; player++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// count the number of cards this player has of every set</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        std::vector&lt;int&gt; sets(settings.<a class="code" href="structSettings.html#a411c7df35c83865a5273ae9bf2d57790">NUM_SETS</a>, 0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> card = 0; card &lt; state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[player].num_cards; card++)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            sets[match[hand_offset + card] / settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a>]++;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// check if there are any new possible quartets, if so update the state</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        for (<span class="keywordtype">int</span> set = 0; set &lt; settings.<a class="code" href="structSettings.html#a411c7df35c83865a5273ae9bf2d57790">NUM_SETS</a>; set++)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">if</span> (sets[set] == settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a>)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="update_8cpp.html#ade7f3b6e3f5bf3f465146e9453421626">update_quartet</a>(settings, state, graph, hand_offset, player, set))</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    newquartet = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        hand_offset += state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[player].num_cards;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// make sure that the player who is onturn has cards left</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (newquartet)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="update_8cpp.html#a05e0bd8b6c4e581dd20efe05e646fe05">update_onturn</a>(settings, state, question);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="ttc" id="agraph_8cpp_html_a2736b779e137cc954ea2df90d4a13327"><div class="ttname"><a href="graph_8cpp.html#a2736b779e137cc954ea2df90d4a13327">graph_possible</a></div><div class="ttdeci">bool graph_possible(const Settings &amp;settings, const State &amp;state)</div><div class="ttdoc">Check if it is possible to create a graph.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8cpp_source.html#l00036">graph.cpp:36</a></div></div>
<div class="ttc" id="agraph_8cpp_html_af03096c2fe0f390705176a42529c71df"><div class="ttname"><a href="graph_8cpp.html#af03096c2fe0f390705176a42529c71df">graph_create</a></div><div class="ttdeci">Graph graph_create(const Settings &amp;settings, const State &amp;state)</div><div class="ttdoc">Create a biparite graph which has a matching if the state is valid.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8cpp_source.html#l00101">graph.cpp:101</a></div></div>
<div class="ttc" id="amatch_8cpp_html_a2f7536c94282af91f35b23dc2f727feb"><div class="ttname"><a href="match_8cpp.html#a2f7536c94282af91f35b23dc2f727feb">match_find</a></div><div class="ttdeci">std::vector&lt; int &gt; match_find(const Graph &amp;graph)</div><div class="ttdoc">Find a match of the given graph.</div><div class="ttdef"><b>Definition:</b> <a href="match_8cpp_source.html#l00047">match.cpp:47</a></div></div>
<div class="ttc" id="astructSettings_html_a411c7df35c83865a5273ae9bf2d57790"><div class="ttname"><a href="structSettings.html#a411c7df35c83865a5273ae9bf2d57790">Settings::NUM_SETS</a></div><div class="ttdeci">const int NUM_SETS</div><div class="ttdoc">The number of sets.</div><div class="ttdef"><b>Definition:</b> <a href="settings_8h_source.html#l00032">settings.h:32</a></div></div>
<div class="ttc" id="aupdate_8cpp_html_a05e0bd8b6c4e581dd20efe05e646fe05"><div class="ttname"><a href="update_8cpp.html#a05e0bd8b6c4e581dd20efe05e646fe05">update_onturn</a></div><div class="ttdeci">void update_onturn(const Settings &amp;settings, State &amp;state, const Question &amp;question)</div><div class="ttdoc">Update the player onturn such that he has cards for sure.</div><div class="ttdef"><b>Definition:</b> <a href="update_8cpp_source.html#l00025">update.cpp:25</a></div></div>
<div class="ttc" id="aupdate_8cpp_html_ade7f3b6e3f5bf3f465146e9453421626"><div class="ttname"><a href="update_8cpp.html#ade7f3b6e3f5bf3f465146e9453421626">update_quartet</a></div><div class="ttdeci">bool update_quartet(const Settings &amp;settings, State &amp;state, const Graph &amp;graph, int hand_offset, int player, int set)</div><div class="ttdoc">Update the state such that the given player has the provided set.</div><div class="ttdef"><b>Definition:</b> <a href="update_8cpp_source.html#l00063">update.cpp:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43259ea462b7339aedd9d3dfc80e0c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43259ea462b7339aedd9d3dfc80e0c5a">&#9670;&nbsp;</a></span>update_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_state </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSettings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structState.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structQuestion.html">Question</a> &amp;&#160;</td>
          <td class="paramname"><em>question</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="round_8h.html#a77da2cb3c716e1673bbfe93f6d167a28">Answer</a> &amp;&#160;</td>
          <td class="paramname"><em>answer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the state of the game according to the question asked and the answer which is given. </p>
<ul>
<li>If the player onturn does not have have a set restriction for the asked set yet, give it a set restriction of one.</li>
<li>If the answer is true.<ul>
<li>Update the set restrictions.<ul>
<li>Increase the player onturn's set restriction by one.</li>
<li>Decrease the player asked set restriction by one (not lower than 0).</li>
</ul>
</li>
<li>Update who has the card which is asked.<ul>
<li>Set the card's player status only to true for the onturn player.</li>
</ul>
</li>
<li>Update the number of cards the players have.<ul>
<li>Increase the player onturn's card count by one.</li>
<li>Decrease the player asked card count by one.</li>
</ul>
</li>
<li>Update the quartets.<ul>
<li>Call function <code>update_quartets</code>.</li>
</ul>
</li>
</ul>
</li>
<li>If the answer is false.<ul>
<li>Update who has the card which is asked.<ul>
<li>Set the card's player status false for the onturn player.</li>
<li>Set the card's player status false for the asked player.</li>
</ul>
</li>
<li>Change onturn.<ul>
<li>Switch onturn to the player asked.</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="update_8cpp.html#ab8c57cbb0958b7b1bfba8337ebac541b" title="Find if there are new quartets and update the state accordingly.">update_quartets</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="update_8cpp_source.html#l00155">155</a> of file <a class="el" href="update_8cpp_source.html">update.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> card = question.<a class="code" href="structQuestion.html#a5b5a73bf2de32d9b8283dc7a119578fc">set</a> * settings.<a class="code" href="structSettings.html#a78cf5ed18d69ce74d769a4a9058154c5">SET_SIZE</a> + question.<a class="code" href="structQuestion.html#a971bbc717d8890226d187afde6e42756">card</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// update the set restriction of the player onturn</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">int</span> *set = &amp;state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a>].sets[question.<a class="code" href="structQuestion.html#a5b5a73bf2de32d9b8283dc7a119578fc">set</a>];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (*set == 0) *set = 1;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (answer) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// update the set restrictions</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a>].sets[question.<a class="code" href="structQuestion.html#a5b5a73bf2de32d9b8283dc7a119578fc">set</a>] += 1;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">int</span> *set = &amp;state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[question.<a class="code" href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">player</a>].sets[question.<a class="code" href="structQuestion.html#a5b5a73bf2de32d9b8283dc7a119578fc">set</a>];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (*set &gt; 0) *set -= 1;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// update who has the card which is asked</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        state.<a class="code" href="structState.html#a7ff72023586f1fa27512f4142f4f98af">cards</a>[card].players = std::vector&lt;bool&gt;(settings.<a class="code" href="structSettings.html#a86e8b42ad2fcbb6bb68f2b02b932899a">NUM_PLAYERS</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        state.<a class="code" href="structState.html#a7ff72023586f1fa27512f4142f4f98af">cards</a>[card].players[state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// update the number of cards the players have</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a>].num_cards += 1;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        state.<a class="code" href="structState.html#a4183466316e6a008061fdf0871d1cc87">players</a>[question.<a class="code" href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">player</a>].num_cards -= 1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">// update the quartets</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="update_8cpp.html#ab8c57cbb0958b7b1bfba8337ebac541b">update_quartets</a>(settings, state, question);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">// update who could have the card which is asked</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        state.<a class="code" href="structState.html#a7ff72023586f1fa27512f4142f4f98af">cards</a>[card].players[state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        state.<a class="code" href="structState.html#a7ff72023586f1fa27512f4142f4f98af">cards</a>[card].players[question.<a class="code" href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">player</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// update the turn</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        state.<a class="code" href="structState.html#a8473e0f33782aa5732beb378a228d383">onturn</a> = question.<a class="code" href="structQuestion.html#a8732aedb9654217fbfe736732c2e4d4b">player</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="ttc" id="astructQuestion_html_a5b5a73bf2de32d9b8283dc7a119578fc"><div class="ttname"><a href="structQuestion.html#a5b5a73bf2de32d9b8283dc7a119578fc">Question::set</a></div><div class="ttdeci">int set</div><div class="ttdoc">The set the card which is asked belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="round_8h_source.html#l00027">round.h:27</a></div></div>
<div class="ttc" id="astructQuestion_html_a971bbc717d8890226d187afde6e42756"><div class="ttname"><a href="structQuestion.html#a971bbc717d8890226d187afde6e42756">Question::card</a></div><div class="ttdeci">int card</div><div class="ttdoc">The card in the set which is asked for.</div><div class="ttdef"><b>Definition:</b> <a href="round_8h_source.html#l00032">round.h:32</a></div></div>
<div class="ttc" id="aupdate_8cpp_html_ab8c57cbb0958b7b1bfba8337ebac541b"><div class="ttname"><a href="update_8cpp.html#ab8c57cbb0958b7b1bfba8337ebac541b">update_quartets</a></div><div class="ttdeci">void update_quartets(const Settings &amp;settings, State &amp;state, const Question &amp;question)</div><div class="ttdoc">Find if there are new quartets and update the state accordingly.</div><div class="ttdef"><b>Definition:</b> <a href="update_8cpp_source.html#l00098">update.cpp:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
